<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Filtro Hier√°rquico Corrigido</title>
</head>
<body>
    <h1>Testando Filtro Hier√°rquico Corrigido</h1>
    <p>Redirecionando para a p√°gina de riscos e testando o subprocesso problem√°tico...</p>
    
    <script>
        // Redirecionar para a p√°gina de riscos
        window.location.href = 'http://localhost:5173/riscos-processos-trabalho';
        
        // Aguardar carregamento e testar
        setTimeout(() => {
            try {
                console.log('üß™ TESTE: Iniciando teste do filtro hier√°rquico corrigido');
                
                // Tentar expandir os filtros
                const expandButton = document.querySelector('[data-testid="expand-filters"], button[aria-expanded="false"]');
                if (expandButton) {
                    console.log('üß™ TESTE: Expandindo filtros...');
                    expandButton.click();
                    
                    // Aguardar carregamento dos dados
                    setTimeout(() => {
                        try {
                            // Tentar selecionar o subprocesso problem√°tico
                            const subprocessoSelect = document.querySelector('select[name="subprocesso"], #subprocesso');
                            if (subprocessoSelect) {
                                console.log('üß™ TESTE: Selecionando subprocesso problem√°tico...');
                                subprocessoSelect.value = '1fb553a9-2426-4fa4-a7dc-8ce87a55225b';
                                
                                // Disparar evento de mudan√ßa
                                const changeEvent = new Event('change', { bubbles: true });
                                subprocessoSelect.dispatchEvent(changeEvent);
                                
                                console.log('üß™ TESTE: Subprocesso selecionado, aguardando filtragem hier√°rquica...');
                                
                                // Verificar se os filtros foram atualizados
                                setTimeout(() => {
                                    const processoSelect = document.querySelector('select[name="processo"], #processo');
                                    const macroprocessoSelect = document.querySelector('select[name="macroprocesso"], #macroprocesso');
                                    
                                    console.log('üß™ TESTE: Verificando se os filtros foram atualizados...');
                                    console.log('üß™ TESTE: Processo selecionado:', processoSelect?.value || 'Nenhum');
                                    console.log('üß™ TESTE: Macroprocesso selecionado:', macroprocessoSelect?.value || 'Nenhum');
                                    
                                    if (processoSelect?.value && macroprocessoSelect?.value) {
                                        console.log('‚úÖ TESTE: SUCESSO! Filtragem hier√°rquica funcionando!');
                                    } else {
                                        console.log('‚ùå TESTE: FALHA! Filtragem hier√°rquica n√£o funcionou.');
                                    }
                                }, 3000);
                            } else {
                                console.log('‚ùå TESTE: Select de subprocesso n√£o encontrado');
                            }
                        } catch (error) {
                            console.error('‚ùå TESTE: Erro ao selecionar subprocesso:', error);
                        }
                    }, 2000);
                } else {
                    console.log('‚ùå TESTE: Bot√£o de expandir filtros n√£o encontrado');
                }
            } catch (error) {
                console.error('‚ùå TESTE: Erro geral:', error);
            }
        }, 1000);
    </script>
</body>
</html>